version: 0.1.0
author: avigaildanesh
accent: anchor
name: Missing Transfer Amount Validation
description: Ensure that token transfers validate the amount being transferred. Transfers should not allow negative values or amounts exceeding the account balance.
severity: Low
certainty: Low
vulnerable_example: https://github.com/Auditware/radar/blob/main/api/tests/mocks/missing_transfer_amount_validation/bad/lib.rs#L13-L18
rule: |
  for source, nodes in ast:
      try:
          transfer_calls = nodes.find_chained_calls("token", "transfer").exit_on_none()
          nodes.find_comparisons_between("amount", call.first().access_path).exit_on_value()
          
          for call in transfer_calls:
              print(call.first().to_result())
      except:
          continue
