version: 0.1.0
author: avigaildanesh
name: Account Precreation DoS
severity: Low
certainty: Low
description: Detects unsafe account owner assignments without prior validation.
vulnerable_example: https://github.com/Auditware/radar/blob/main/api/tests/mocks/account_precreation_dos/bad/lib.rs#L13
rule: |
  for source, nodes in ast:
      try:
          owner_assigns = nodes.find_assignments("owner", "key").exit_on_none()
          require_exists = nodes.find_by_names("require").exit_on_value()
          print(owner_assigns.first().first().to_result())
      except:
          continue