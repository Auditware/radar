version: 0.1.0
author: avigaildanesh
name: Random Authority Generation
severity: Low
certainty: Low
description: Detects generation of random/unique Pubkey for authority which bypasses proper authority validation.
vulnerable_example: https://github.com/Auditware/radar/blob/main/api/tests/mocks/cpi_authority_bypass/bad/src/lib.rs#L12-L15
rule: |
  for source, nodes in ast:
      try:
          print(nodes.find_by_names("new_unique").exit_on_none().first().to_result())
      except:
          continue