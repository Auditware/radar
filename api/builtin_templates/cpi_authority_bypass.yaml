version: 0.1.0
author: avigaildanesh
name: Random Authority Generation
severity: Low
certainty: Low
description: Detects generation of random/unique Pubkey for authority which bypasses proper authority validation
rule: |
  for source, nodes in ast:
      try:
          # Find any nodes with "new_unique" identifier
          new_unique_calls = nodes.find_by_names("new_unique").exit_on_none()
          
          # Report all random authority generations
          print(new_unique_calls.first().to_result())
      except:
          continue