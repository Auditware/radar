version: 0.1.0
author: avigaildanesh
accent: anchor
name: Unchecked Arithmetics
description: Arithmetic operations without overflow checks can lead to unexpected behavior, incorrect calculations, or security vulnerabilities when values exceed their maximum limits.
severity: Low
certainty: Medium
vulnerable_example: https://github.com/Auditware/radar/blob/main/api/tests/mocks/unchecked_arithmetics/bad/lib.rs#L14
rule: |
  for source, nodes in ast:
    try:
      funcs = nodes.find_all_functions().exit_on_none()
      for func in funcs:
        func.find_by_names("checked_add", "checked_sub", "checked_mul", "checked_div").exit_on_value()
        for unchecked_comparison in func.find_binary_operations("*", "+", "-"):
          print(unchecked_comparison.parent.to_result())
    except:
      continue