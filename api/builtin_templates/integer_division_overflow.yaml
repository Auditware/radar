version: 0.1.0
author: forefy
name: Integer Division Overflow
description: Division operations may result in unexpected behavior or panic when dividing by zero or dividing MIN by -1. Use checked_div() instead of direct division.
severity: Low
certainty: Medium
rule: |
  for source, nodes in ast:
    try:
      funcs = nodes.find_all_functions().exit_on_none()
      for func in funcs:
        access_path = func.access_path or ""
        if ".impl." not in access_path:
          continue
        
        func.find_by_names("checked_div").exit_on_value()
        
        for div_op in func.find_binary_operations("/"):
          print(div_op.parent.to_result())
    except:
      continue
