version: 0.1.0
author: forefy
accent: solidity
name: Use of ABI Encode on Array of Arrays
description: Passing multi-dimensional arrays to `abi.encode` can lead to inconsistent
  behavior or interpretation on some solidity versions due to how arrays are encoded
  and flattened in memory.
severity: Low
certainty: Medium
rule: "for source, nodes in ast:\n  try:\n      abi_encode_nodes = nodes.find_nodes_by_type_identifiers(\"\
  t_function_abiencode\").exit_on_none()\n      for node in abi_encode_nodes:\n  \
  \        multi_d_array_nodes = node.parent.find_nodes_by_type_strings(r\"\\[\\d+\\\
  ].*\\[\\d+\\]\")\n          if len(multi_d_array_nodes) > 0:\n              print(node.to_result())\n\
  \  except:\n      continue"
