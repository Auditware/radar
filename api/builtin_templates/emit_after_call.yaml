version: 0.1.0
author: forefy
language: solidity
accent: ""
name: Emitting After call
description: Emitting after an external call opens up the possibility for the event order to be disrupted in cases of reentrancy
severity: Low
certainty: Low
rule: |
  for source, nodes in ast:
    try:
        emits = nodes.find_functions_by_name_patterns("emit").exit_on_none()
        for node in emits:
            if len(node.find_nodes_by_member_names("call")) != 0:
                print(node.to_result())
    except:
        continue
