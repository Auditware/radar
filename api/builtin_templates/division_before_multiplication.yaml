version: 0.1.0
author: avigaildanesh
accent: anchor
name: Division Before Multiplication
description: Performing division before multiplication causes precision loss due to truncation, leading to incorrect calculations in financial operations.
severity: Medium
certainty: Medium
vulnerable_example: https://github.com/Auditware/radar/blob/main/api/tests/mocks/division_before_multiplication/bad/src/lib.rs#L13
rule: |
  for source, nodes in ast:
      try:
          funcs = nodes.find_all_functions().exit_on_none()
          
          mul_ops = funcs.find_binary_operations("*").exit_on_none()
          
          for mul_op in mul_ops:
              mul_children = mul_op.find_binary_operations("/")
              if len(mul_children) > 0:
                  print(mul_op.to_result())
      except:
          continue
